/* ==================== 登录提示组件 ==================== */
.moki-login-prompt {
  background: rgba(0, 0, 0, 0.9);
  border-radius: 12px;
  padding: 0;
  margin-bottom: 16px;
  width: 100%;
  box-sizing: border-box;
}

.moki-login-prompt-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 40px;
  text-align: center;
}

.moki-login-prompt-icon {
  font-size: 48px;
  margin-bottom: 16px;
}

.moki-login-prompt-title {
  color: #e5e7eb;
  font-size: 16px;
  font-weight: 500;
  margin: 0 0 24px 0;
  line-height: 1.5;
}

.moki-login-prompt-button {
  background: #4ade80;
  color: #000;
  border: none;
  padding: 10px 32px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 600;
  font-size: 15px;
  transition:
    background 0.2s,
    transform 0.1s;
}

.moki-login-prompt-button:hover {
  background: #22c55e;
}

.moki-login-prompt-button:active {
  transform: scale(0.98);
}
/* ==================== Tooltip 容器 ==================== */
.moki-tooltip {
  /* 定位 */
  position: fixed;
  z-index: 10000;

  /* 尺寸 */
  width: 416px; /* 原 320px + 30% = 416px */
  padding: 20px;
  box-sizing: border-box;

  /* 视觉 */
  background: rgba(0, 0, 0, 0.95);
  color: #fff;
  border-radius: 8px;
  box-shadow:
    0 4px 6px rgba(0, 0, 0, 0.3),
    0 0 0 1px rgba(255, 255, 255, 0.1);

  /* 排版 */
  font-family:
    system-ui,
    -apple-system,
    'Segoe UI',
    Roboto,
    Arial,
    sans-serif;
  font-size: 14px;
  line-height: 1.5;
  direction: ltr;
  text-align: left;

  /* 滚动 */
  overflow-x: hidden; /* 禁用水平滚动 */

  /* 动画 */
  animation: tooltipFadeIn 0.2s ease;
  pointer-events: none;
}

@keyframes tooltipFadeIn {
  from {
    opacity: 0;
    transform: translateX(5px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* 左侧箭头（指向字幕行） */
.moki-tooltip::before {
  content: '';
  position: absolute;
  right: -8px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 8px 0 8px 8px;
  border-color: transparent transparent transparent rgba(0, 0, 0, 0.95);
}

/* ==================== Tooltip 内容样式 ==================== */

/* 主单词区域容器 */
.moki-tooltip-word-section {
  margin-bottom: 24px;
}

/* 单词标题 */
.moki-tooltip-word {
  font-size: 48px;
  font-weight: 700;
  color: #4ade80;
  line-height: 1.2;
  margin-bottom: 0;
  word-break: break-word;
  text-align: left;
  padding-right: 80px; /* 为右上角的按钮留出空间，避免长单词与按钮重叠 */
}

/* 词性和定义容器 */
.moki-tooltip-definition-container {
  display: flex;
  align-items: baseline;
  gap: 8px;
  margin-bottom: 16px;
}

/* Short 模式下的定义容器（在 word-section 内，不需要自己的 margin） */
.moki-tooltip-word-section .moki-tooltip-definition-container {
  margin-bottom: 0;
}

/* 词性标签 */
.moki-tooltip-pos-label {
  font-size: 13px;
  color: #ffffff;
  font-style: italic;
  line-height: 1.5;
  flex-shrink: 0;
}

/* 简短定义 */
.moki-tooltip-definition {
  font-size: 18px;
  color: #ffffff;
  line-height: 1.5;
  margin-bottom: 0;
  flex: 1;
}

/* 词性切换器容器 */
.moki-tooltip-pos-switcher {
  display: flex;
  margin-top: 16px;
  margin-bottom: 24px;
  width: 100%;
}

/* 词性切换器按钮 */
.moki-tooltip-pos-switcher-btn {
  flex: 1;
  padding: 4px 12px;
  font-size: 12px;
  font-weight: 500;
  line-height: 1.5;
  border: 2px solid #4ade80;
  background: transparent;
  color: #4ade80;
  cursor: pointer;
  transition: all 0.2s;
  margin-left: 0;
}

/* 第一个按钮 */
.moki-tooltip-pos-switcher-btn:first-child {
  border-top-left-radius: 6px;
  border-bottom-left-radius: 6px;
}

/* 最后一个按钮 */
.moki-tooltip-pos-switcher-btn:last-child {
  border-top-right-radius: 6px;
  border-bottom-right-radius: 6px;
}

/* 中间按钮（合并边框） */
.moki-tooltip-pos-switcher-btn:not(:first-child) {
  margin-left: -2px;
  border-left-width: 0;
}

/* 选中状态 */
.moki-tooltip-pos-switcher-btn.active {
  background: #4ade80;
  color: #000000;
  border-left-width: 2px;
}

/* 禁用状态 */
.moki-tooltip-pos-switcher-btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

/* Hover 效果（仅未选中） */
.moki-tooltip-pos-switcher-btn:not(.active):hover:not(:disabled) {
  background: rgba(74, 222, 128, 0.1);
}

/* 分隔线章节标签 */
.moki-tooltip-section-label {
  color: #374151; /* text-gray-700 */
  font-size: 12px;
  margin-bottom: 2px;
  line-height: 1.5;
}

/* 分隔线 */
.moki-tooltip-divider {
  height: 1px;
  background: #374151;
  margin-bottom: 24px;
}

/* 翻译文本 */
.moki-tooltip-translation {
  font-size: 14px;
  color: #fff;
  line-height: 1.6;
  word-break: break-word;
}

/* ==================== 骨架屏样式 ==================== */

/* 音标骨架容器 */
.moki-tooltip-phonetic-skeleton {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
  margin-top: 0;
}

/* 翻译骨架容器 (词性 + 定义) */
.moki-tooltip-definition-skeleton {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 16px;
}

/* 底部文本骨架 */
.moki-tooltip-bottom-skeleton {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* 骨架条 */
.moki-skeleton-bar {
  background: #374151;
  border-radius: 4px;
  animation: skeleton-pulse 1.5s ease-in-out infinite;
}

/* 骨架圆 */
.moki-skeleton-circle {
  width: 16px;
  height: 16px;
  background: #374151;
  border-radius: 50%;
  animation: skeleton-pulse 1.5s ease-in-out infinite;
}

/* 骨架脉动动画 */
@keyframes skeleton-pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

/* ==================== Expanded Loading 样式 ==================== */

/* 加载按钮骨架（收藏/关闭按钮） */
.moki-tooltip-loading-button {
  position: absolute;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  z-index: 10;
}

/* 词性切换器骨架 */
.moki-tooltip-pos-switcher-skeleton {
  display: flex;
  gap: 0;
  margin-top: 16px;
  margin-bottom: 24px;
}

/* 释义骨架 */
.moki-tooltip-senses-skeleton {
  margin-top: 0;
  margin-bottom: 24px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* ============================================ */
/* 短语相关样式 */
/* ============================================ */

/* 短语部分容器 */
.moki-tooltip-phrases {
  margin-top: 0;
  margin-bottom: 24px;
  padding-top: 0;
}

/* 单个短语 */
.moki-tooltip-phrase {
  margin-bottom: 0;
}

/* 多个短语时，第二个及以后的短语添加上边距 */
.moki-tooltip-phrase-extra {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid rgba(255, 255, 255, 0.08);
}

/* 短语头部（短语文本 + 类型标签） */
.moki-tooltip-phrase-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 2px;
}

/* 短语文本 */
.moki-tooltip-phrase-text {
  color: #818cf8;
  font-weight: 600;
  font-size: 18px;
}

/* 短语类型标签 */
.moki-tooltip-phrase-type {
  display: inline-block;
  padding: 2px 6px;
  background: rgba(99, 102, 241, 0.2);
  border-radius: 3px;
  font-size: 10px;
  font-weight: 500;
  text-transform: uppercase;
  color: #c7d2fe;
}

/* 短语释义 */
.moki-tooltip-phrase-meaning {
  color: #6b7280;
  font-size: 13px;
  margin-bottom: 4px;
}

/* 短语解释（可选） */
.moki-tooltip-phrase-explanation {
  color: #9ca3af;
  font-size: 12px;
  line-height: 1.4;
  font-style: italic;
}

/* ==================== 展开的 Tooltip ==================== */
/* 展开状态的 tooltip */
.moki-tooltip.expanded {
  pointer-events: auto; /* 可交互（点击单词切换回简短模式） */
  overflow-y: auto; /* 内容过多时滚动 */
  animation: tooltipExpand 0.3s ease; /* 展开动画 */
  box-shadow:
    0 8px 20px rgba(0, 0, 0, 0.5),
    /* 更强阴影 */ 0 0 0 1px rgba(255, 255, 255, 0.1);
}

/* 展开动画（仅 opacity，max-height 由 JS 动态设置） */
@keyframes tooltipExpand {
  from {
    opacity: 0.8;
  }
  to {
    opacity: 1;
  }
}

/* 自定义滚动条（展开时） */
.moki-tooltip.expanded::-webkit-scrollbar {
  width: 6px;
}

.moki-tooltip.expanded::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 3px;
}

.moki-tooltip.expanded::-webkit-scrollbar-thumb {
  background: rgba(74, 222, 128, 0.3);
  border-radius: 3px;
}

.moki-tooltip.expanded::-webkit-scrollbar-thumb:hover {
  background: rgba(74, 222, 128, 0.5);
}

/* ==================== 关闭按钮 ==================== */
.moki-tooltip-close {
  position: absolute;
  top: 20px;
  right: 8px;
  width: 24px;
  height: 24px;
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.6);
  cursor: pointer;
  transition: color 0.2s;
  padding: 0;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

.moki-tooltip-close:hover {
  color: rgba(255, 255, 255, 1);
}

.moki-tooltip-close svg {
  width: 24px;
  height: 24px;
  display: block;
  pointer-events: none;
}

/* ==================== 收藏按钮 ==================== */
.moki-tooltip-favorite-btn {
  position: absolute;
  top: 20px;
  right: 40px;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.6);
  cursor: pointer;
  transition: color 0.2s;
  z-index: 10;
}

.moki-tooltip-favorite-btn:hover {
  color: rgba(255, 255, 255, 1);
}

.moki-tooltip-favorite-btn.active {
  color: #4ade80;
  cursor: pointer;
}

/* 取消收藏中的呼吸动画 */
.moki-tooltip-favorite-btn.unfavoriting {
  color: #4ade80;
  cursor: not-allowed;
  animation: moki-favorite-pulse 1s ease-in-out infinite;
}

@keyframes moki-favorite-pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.4;
  }
}

.moki-tooltip-favorite-btn svg {
  width: 20px;
  height: 20px;
  display: block;
  pointer-events: none;
}

/* ==================== 加载动画（替代关闭按钮）==================== */
.moki-tooltip-loading {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 16px;
  height: 16px;
  margin: 4px; /* 居中对齐（24px 容器中放置 16px 圆圈）*/
  border: 2px solid rgba(255, 255, 255, 0.2);
  border-top-color: rgba(74, 222, 128, 0.8);
  border-radius: 50%;
  animation: moki-tooltip-spin 0.8s linear infinite;
  z-index: 10;
}

@keyframes moki-tooltip-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* ==================== 音标和发音按钮 ==================== */

/* 音标和发音按钮容器 */
.moki-tooltip-phonetic-container {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

/* 音标样式 */
.moki-tooltip-phonetic {
  font-size: 13px;
  color: #9ca3af;
  margin-bottom: 0;
}

/* 发音按钮 */
.moki-tooltip-pronunciation-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  padding: 0;
  background: none;
  border: none;
  color: #9ca3af;
  cursor: pointer;
  transition: color 0.2s;
}

.moki-tooltip-pronunciation-btn:hover {
  color: #4ade80;
}

.moki-tooltip-pronunciation-btn svg {
  width: 16px;
  height: 16px;
  display: block;
  pointer-events: none;
}

/* Not yet included 提示 */
.moki-tooltip-not-included {
  color: #9ca3af; /* 浅灰色 - 与音标相同 */
  font-size: 14px;
  margin-top: 0;
  margin-bottom: 24px;
}

/* ==================== POS Senses 容器（释义列表） ==================== */
.moki-tooltip-pos-senses {
  margin-top: 0;
  margin-bottom: 24px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* 单个释义条目 */
.moki-tooltip-pos-entry {
  display: flex;
  align-items: baseline;
  line-height: 1.5;
}

/* 释义编号 */
.moki-tooltip-sense-number {
  font-size: 20px;
  color: #9ca3af;
  font-weight: 400;
  width: 40px; /* 从 28px 增加到 40px，增加间隔 */
  text-align: left;
  flex-shrink: 0;
  line-height: 1;
}

/* 释义文本容器 */
.moki-tooltip-sense-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

/* 释义主文本 */
.moki-tooltip-sense-text {
  font-size: 14px;
  color: #ffffff;
  line-height: 1.2;
}

/* ==================== Examples 部分（在释义条目内部） ==================== */

/* 例句容器（保持在释义条目内部） */
.moki-tooltip-example-wrapper {
  margin-left: 0;
  margin-top: 4px;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

/* 例句原文 */
.moki-tooltip-example-text {
  color: #9ca3af;
  font-size: 12px;
  line-height: 1.5;
  margin-bottom: 0;
}

/* 例句翻译 */
.moki-tooltip-example-translation {
  color: #6b7280;
  font-size: 11px;
  line-height: 1.5;
  opacity: 0.8;
  padding-left: 0;
}
/* ==================== Moki 侧边栏根容器 ==================== */
.moki-sidebar {
  /* 定位：正常文档流，作为独立元素插入在推荐视频上方 */
  position: relative;

  /* 尺寸：撑满 #secondary 宽度，最小高度确保可见 */
  width: 100%;
  min-height: 600px;

  /* 视觉：半透明黑色背景 + 白色文字 */
  background: rgba(0, 0, 0, 0.9);
  color: #fff;

  /* 布局 */
  box-sizing: border-box;
  overflow: hidden;

  /* 排版方向：强制从左到右 */
  direction: ltr;

  /* 字体 */
  font-family:
    system-ui,
    -apple-system,
    'Segoe UI',
    Roboto,
    Arial,
    sans-serif;

  /* 圆角（与 YouTube 风格一致） */
  border-radius: 12px;

  /* 边距 */
  margin-bottom: 16px;
}

/* ==================== 侧边栏遮罩层（录制时禁止交互） ==================== */
.moki-sidebar-overlay {
  /* 定位：覆盖整个侧边栏 */
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;

  /* 默认隐藏 */
  opacity: 0;
  visibility: hidden;
  pointer-events: none;

  /* 视觉：灰色半透明 */
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(2px);

  /* 确保在最上层 */
  z-index: 100;

  /* 圆角（与容器一致） */
  border-radius: 12px;

  /* 过渡动画 */
  transition:
    opacity 0.2s ease,
    visibility 0.2s ease;
}

/* 显示遮罩层 */
.moki-sidebar-overlay.visible {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}

/* ==================== 内容区域（可滚动） ==================== */
.moki-sidebar-content {
  /* 相对定位 */
  position: relative;
  width: 100%;
  max-height: 800px;

  /* 滚动设置 */
  overflow-y: auto;
  overflow-x: hidden;
  padding: 12px 0;

  /* 平滑滚动 */
  scroll-behavior: smooth;
}

/* ==================== 字幕列表容器 ==================== */
.moki-sidebar-list {
  padding: 0;
  margin: 0;
}

/* ==================== 字幕项基础样式 ==================== */
.moki-subtitle-item {
  /* 布局 */
  display: flex;
  align-items: flex-start;
  width: 100%;
  padding: 12px 16px;
  box-sizing: border-box;

  /* 文字 */
  font-size: 16px;
  font-weight: 400;
  line-height: 1.5;
  color: #fff;

  /* 交互 */
  cursor: pointer;
  user-select: text;
  transition: background-color 0.2s ease;

  /* 边距 */
  margin-bottom: 2px;
}

/* 奇数行背景（深色） */
.moki-subtitle-item.odd {
  background: #0a0a0a;
}

/* 偶数行背景（稍浅） */
.moki-subtitle-item.even {
  background: #1a1a1a;
}

/* Hover 效果 */
.moki-subtitle-item:hover {
  background: rgba(255, 255, 255, 0.15);
}

/* ==================== 播放图标容器 ==================== */
.moki-playing-icon {
  /* 布局 */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  min-width: 20px;
  margin-right: 8px;
  position: relative;
  flex-shrink: 0;
  align-self: center; /* 覆盖父元素的 flex-start，使图标垂直居中 */

  /* 默认不显示 */
  opacity: 0;
  transition: opacity 0.2s ease;

  /* 交互 */
  cursor: pointer;
}

/* 正在播放时显示播放图标 */
.moki-subtitle-item.playing .moki-playing-icon {
  opacity: 1;
  cursor: default; /* 播放中的行不可点击 */
}

/* Hover 非播放行时显示回播图标 */
.moki-subtitle-item:hover:not(.playing) .moki-playing-icon {
  opacity: 0.4; /* 更暗的绿色，降低透明度 */
}

.moki-subtitle-item:hover:not(.playing) .moki-playing-icon:hover {
  opacity: 1; /* hover 时变为亮绿色 */
}

/* 使用 CSS 创建播放图标（三角形 - 正在播放） */
.moki-subtitle-item.playing .moki-playing-icon::before {
  content: '';
  display: block;
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 6px 0 6px 10px;
  border-color: transparent transparent transparent #4ade80;
}

/* 使用 CSS 创建回播图标（三角形 + 竖线 - hover 状态） */
.moki-subtitle-item:hover:not(.playing) .moki-playing-icon::before {
  content: '';
  display: block;
  width: 0;
  height: 0;
  border-style: solid;
  border-width: 6px 0 6px 8px;
  border-color: transparent transparent transparent #4ade80;
}

.moki-subtitle-item:hover:not(.playing) .moki-playing-icon::after {
  content: '';
  position: absolute;
  left: 2px;
  top: 50%;
  transform: translateY(-50%);
  width: 2px;
  height: 12px;
  background: #4ade80;
}

/* ==================== 字幕内容容器 ==================== */
.moki-subtitle-content {
  /* 布局 */
  flex: 1;
  display: inline;
  line-height: 1.5;
}

/* ==================== 滚动条样式 ==================== */
.moki-sidebar-content::-webkit-scrollbar {
  width: 8px;
}

.moki-sidebar-content::-webkit-scrollbar-track {
  background: #000;
}

.moki-sidebar-content::-webkit-scrollbar-thumb {
  background: #444;
  border-radius: 4px;
}

.moki-sidebar-content::-webkit-scrollbar-thumb:hover {
  background: #666;
}

/* ==================== 空状态提示 ==================== */
.moki-subtitle-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 40px 20px;
  text-align: center;
  color: rgba(255, 255, 255, 0.6);
}

.moki-subtitle-empty p {
  margin: 8px 0;
  font-size: 14px;
  line-height: 1.5;
}

/* ==================== Token 样式 ==================== */
.moki-token {
  /* 基础样式 */
  display: inline;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
}

/* 无罗马音的 token 直接显示下划线 */
.moki-token:not(:has(.moki-token-with-roman)) {
  border-bottom: 1px dashed rgba(255, 255, 255, 0.3);
  padding-bottom: 1px;
}

.moki-token:not(:has(.moki-token-with-roman)):hover {
  color: #4ade80;
  border-bottom: 1px solid #4ade80;
}

/* 标点符号和数字：无交互效果 */
.moki-token-punctuation {
  display: inline;
  cursor: default;
}

/* 被点击/激活的 token：青色字体 + 下划线 */
/* 无罗马音的 token：只改变字体颜色和下划线，不加背景 */
.moki-token.active:not(:has(.moki-token-with-roman)) {
  color: #22d3ee; /* 青色字体 */
  border-bottom-color: #22d3ee; /* 青色下划线 */
  border-bottom-style: solid;
}

/* 有罗马音的 token：只改变字符和罗马音颜色，不加背景 */
.moki-token.active .moki-char {
  color: #22d3ee; /* 青色字符 */
  border-bottom-color: #22d3ee; /* 青色下划线 */
  border-bottom-style: solid;
}

.moki-token.active .moki-roman {
  color: #22d3ee; /* 青色罗马音 */
}

/* 已收藏的 token：金色高亮（基于 lemma） */
/* 无罗马音的 token：金色字体 + 实线下划线 */
.moki-token.collected:not(:has(.moki-token-with-roman)) {
  color: #fbbf24; /* 金色字体 */
  border-bottom: 1px solid #fbbf24; /* 金色下划线 */
}

/* 有罗马音的 token：金色字符和罗马音 */
.moki-token.collected .moki-char {
  color: #fbbf24; /* 金色字符 */
  border-bottom: 1px solid #fbbf24; /* 金色下划线 */
}

.moki-token.collected .moki-roman {
  color: #fbbf24; /* 金色罗马音 */
}

/* hover 时保持金色（不变绿） */
.moki-token.collected:hover:not(:has(.moki-token-with-roman)) {
  color: #fbbf24;
  border-bottom-color: #fbbf24;
}

.moki-token.collected:hover .moki-char {
  color: #fbbf24;
}

/* ==================== 罗马音样式 ==================== */

/* 带罗马音的 token 容器 */
.moki-token-with-roman {
  display: inline-flex;
  flex-direction: row;
  align-items: flex-end;
  gap: 0;
}

/* 单个字符组（罗马音 + 字符） */
.moki-char-group {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  position: relative;
}

/* 罗马音样式（字符上方） */
.moki-roman {
  font-size: 10px;
  line-height: 1.2;
  color: #9ca3af;
  white-space: nowrap;
  user-select: none;
  pointer-events: none;
  margin-bottom: 1px;
}

/* 原字符样式（字符本体） */
.moki-char {
  display: inline-block;
  padding-bottom: 1px;
  transition: all 0.2s ease;
}

/* 罗马音容器统一下划线（在整个单词下方，而不是每个字符单独下划线） */
.moki-token .moki-token-with-roman {
  border-bottom: 1px dashed rgba(255, 255, 255, 0.3);
  padding-bottom: 1px;
  transition: all 0.2s ease;
}

/* 标点符号和数字的罗马音容器没有下划线 */
.moki-token-punctuation .moki-token-with-roman {
  border-bottom: none;
}

/* 占位符容器（无罗马音数据）没有下划线 */
.moki-token .moki-roman-placeholder {
  border-bottom: none;
}

/* Hover 时整个单词变绿，下划线变实线（仅普通单词，排除占位符） */
.moki-token:hover .moki-token-with-roman:not(.moki-roman-placeholder) {
  border-bottom: 1px solid #4ade80;
}

.moki-token:hover .moki-char {
  color: #4ade80;
}

/* Hover 时保持罗马音样式不变 */
.moki-token:hover .moki-roman {
  color: #9ca3af;
}

/* ==================== Token 可点击样式 ==================== */
.moki-token {
  cursor: pointer;
  user-select: none; /* 防止误选文本 */
  transition: transform 0.1s;
}

.moki-token:active {
  transform: scale(0.98); /* 点击反馈 */
}

/* ==================== Recording Indicator ==================== */
.moki-recording-indicator {
  position: absolute;
  top: 24px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10000;
  pointer-events: none;
  animation: moki-recording-fade-in 0.2s ease-out;
}

@keyframes moki-recording-fade-in {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }
}

/* Recording dot blinking animation */
.moki-recording-indicator .moki-recording-dot {
  animation: moki-recording-blink 1.5s ease-in-out infinite;
}

@keyframes moki-recording-blink {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.3;
  }
}

/* ==================== Theater/Fullscreen Mode 样式 ==================== */
/* 注意：父容器的 flexbox 布局通过 JS 内联样式设置（view.ts applyParentContainerStyles）*/
/* 这里只定义 CSS 无法通过内联样式表达的样式（如背景色、z-index、子元素样式） */

/* 剧院/全屏模式下的侧边栏基础样式 */
.moki-sidebar.mode-theater,
.moki-sidebar.mode-fullscreen {
  /* 更深的背景色，增强可读性 */
  background: rgba(0, 0, 0, 0.95);
}

/* 全屏模式下确保在视频上方 */
.moki-sidebar.mode-fullscreen {
  z-index: 2147483647;
}

/* 剧院/全屏模式下内容区域填满高度 */
.moki-sidebar.mode-theater .moki-sidebar-content,
.moki-sidebar.mode-fullscreen .moki-sidebar-content {
  max-height: 100%;
  height: 100%;
}

/* 剧院/全屏模式下遮罩层去掉圆角 */
.moki-sidebar.mode-theater .moki-sidebar-overlay,
.moki-sidebar.mode-fullscreen .moki-sidebar-overlay {
  border-radius: 0;
}
/**
 * Moki Control Button Styles
 *
 * Matches YouTube's native button styling while adding Moki brand colors.
 */

/* ============================================================================
   Button Base Styles
   ============================================================================ */

.moki-control-button {
  /* Match YouTube's button size */
  width: 48px;
  height: 48px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  background: transparent;
  border: none;
  outline: none;
  padding: 0;
  margin: 0;

  /* Transition for smooth state changes */
  transition: opacity 0.2s ease;
}

.moki-control-button:focus {
  outline: none;
}

/* ============================================================================
   Icon Styles
   ============================================================================ */

.moki-control-icon {
  width: 24px;
  height: 24px;
  fill: currentColor;

  /* Transition for color changes */
  transition: fill 0.2s ease;
}

/* ============================================================================
   Button States
   ============================================================================ */

/* Disabled state (default - Moki is off) */
.moki-control-button.moki-control-disabled {
  color: #ffffff;
  opacity: 0.9;
}

.moki-control-button.moki-control-disabled:hover {
  opacity: 1;
}

/* Enabled state (Moki is on) - Green color */
.moki-control-button.moki-control-enabled {
  color: #4ade80;
  opacity: 1;
}

.moki-control-button.moki-control-enabled:hover {
  color: #22c55e;
}

/* Unavailable state (no subtitles) - Gray color */
.moki-control-button.moki-control-unavailable {
  color: #ffffff;
  opacity: 0.3;
  cursor: not-allowed;
}

.moki-control-button.moki-control-unavailable:hover {
  opacity: 0.3;
}

/* Loading state - Animated */
.moki-control-button.moki-control-loading {
  color: #4ade80;
  opacity: 0.7;
  animation: moki-pulse 1s ease-in-out infinite;
}

@keyframes moki-pulse {
  0%,
  100% {
    opacity: 0.5;
  }
  50% {
    opacity: 1;
  }
}

/* ============================================================================
   Tooltip Styles
   ============================================================================ */

.moki-control-tooltip {
  position: fixed;
  z-index: 2147483647;
  background-color: rgba(28, 28, 28, 0.9);
  color: #ffffff;
  font-size: 12px;
  font-family: 'YouTube Noto', Roboto, Arial, sans-serif;
  padding: 8px 12px;
  border-radius: 4px;
  white-space: nowrap;
  pointer-events: none;

  /* Hidden by default */
  opacity: 0;
  visibility: hidden;
  transform: translate(-50%, -100%);

  /* Transition for show/hide */
  transition:
    opacity 0.15s ease,
    visibility 0.15s ease;
}

.moki-control-tooltip.visible {
  opacity: 1;
  visibility: visible;
}

/* Tooltip arrow */
.moki-control-tooltip::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 50%;
  transform: translateX(-50%);
  border: 5px solid transparent;
  border-top-color: rgba(28, 28, 28, 0.9);
}

/* ============================================================================
   Menu Styles
   ============================================================================ */

.moki-control-menu {
  position: absolute;
  bottom: 70px;
  right: 12px;
  width: 280px;
  background-color: #171717;
  border: 1px solid #1e2939;
  border-radius: 10px;
  overflow: hidden;
  z-index: 2147483647;
  font-family:
    'Inter',
    'Noto Sans JP',
    'Noto Sans SC',
    -apple-system,
    sans-serif;

  /* Hidden by default */
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transform: translateY(10px);
  transition:
    opacity 0.2s ease,
    visibility 0.2s ease,
    transform 0.2s ease;
}

.moki-control-menu.visible {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  transform: translateY(0);
}

/* Menu Row */
.moki-menu-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 48px;
  padding: 0 16px;
}

.moki-menu-toggle-row {
  border-bottom: 1px solid #1e2939;
}

.moki-menu-label {
  font-size: 14px;
  font-weight: 400;
  color: #ffffff;
  letter-spacing: -0.15px;
}

/* Toggle Switch */
.moki-menu-toggle {
  width: 44px;
  height: 24px;
  background-color: #374151;
  border-radius: 12px;
  cursor: pointer;
  position: relative;
  transition: background-color 0.2s ease;
}

.moki-menu-toggle.active {
  background-color: #4ade80;
}

.moki-menu-toggle-knob {
  width: 20px;
  height: 20px;
  background-color: #ffffff;
  border-radius: 50%;
  position: absolute;
  top: 2px;
  left: 2px;
  transition: transform 0.2s ease;
}

.moki-menu-toggle.active .moki-menu-toggle-knob {
  transform: translateX(20px);
}

/* Subtitle Row */
.moki-menu-value {
  display: flex;
  align-items: center;
  gap: 8px;
  color: #99a1af;
  font-size: 14px;
  cursor: pointer;
}

.moki-menu-value svg {
  stroke: #99a1af;
}

.moki-menu-subtitle-row:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

/* ============================================================================
   Submenu Styles
   ============================================================================ */

.moki-control-submenu {
  position: absolute;
  bottom: 70px;
  right: 12px;
  width: 280px;
  background-color: #171717;
  border: 1px solid #1e2939;
  border-radius: 10px;
  overflow: hidden;
  z-index: 2147483647;
  font-family:
    'Inter',
    'Noto Sans JP',
    'Noto Sans SC',
    -apple-system,
    sans-serif;

  /* Hidden by default */
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transform: translateY(10px);
  transition:
    opacity 0.2s ease,
    visibility 0.2s ease,
    transform 0.2s ease;
}

.moki-control-submenu.visible {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  transform: translateY(0);
}

/* Submenu Header */
.moki-submenu-header {
  display: flex;
  align-items: center;
  gap: 8px;
  height: 48px;
  padding: 0 16px;
  border-bottom: 1px solid #1e2939;
  cursor: pointer;
  color: #ffffff;
  font-size: 14px;
  font-weight: 400;
}

.moki-submenu-header:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

.moki-submenu-header svg {
  stroke: #99a1af;
}

/* Submenu Content */
.moki-submenu-content {
  max-height: 300px;
  overflow-y: auto;
}

/* Submenu Row */
.moki-submenu-row {
  display: flex;
  align-items: center;
  height: 44px;
  padding: 0 16px;
  cursor: pointer;
  color: #ffffff;
  font-size: 14px;
  transition: background-color 0.15s ease;
}

.moki-submenu-row:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

.moki-submenu-row.selected {
  color: #4ade80;
}

.moki-submenu-check {
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 8px;
}

.moki-submenu-check svg {
  stroke: #4ade80;
}

.moki-submenu-label {
  flex: 1;
}

/* Empty state */
.moki-submenu-empty {
  padding: 24px 16px;
  text-align: center;
  color: #6b7280;
  font-size: 14px;
}

/* Scrollbar styling for submenu */
.moki-submenu-content::-webkit-scrollbar {
  width: 6px;
}

.moki-submenu-content::-webkit-scrollbar-track {
  background: transparent;
}

.moki-submenu-content::-webkit-scrollbar-thumb {
  background-color: rgba(255, 255, 255, 0.2);
  border-radius: 3px;
}

.moki-submenu-content::-webkit-scrollbar-thumb:hover {
  background-color: rgba(255, 255, 255, 0.3);
}
/* ==================== 字幕条容器 ==================== */
.moki-subtitle-bar {
  position: fixed;
  left: 50%;
  bottom: 18%;
  transform: translateX(-50%);
  width: 85%;
  z-index: 10;
  pointer-events: none;

  /* Flexbox 布局 */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;

  /* 字体 */
  font-family:
    system-ui,
    -apple-system,
    'Segoe UI',
    Roboto,
    Arial,
    sans-serif;
  color: white;

  /* 动画 */
  transition: opacity 120ms ease-out;
  opacity: 0;
}

/* ==================== 字幕行（原文和翻译） ==================== */
.moki-subtitle-line {
  display: inline-block;
  width: fit-content;
  padding: 2px 12px;
  text-align: center;
  white-space: pre-wrap;
  font-weight: 400;
  font-size: clamp(1.2em, 1.8vw, 3em);
  color: rgba(255, 255, 255, 0.8);
  background-color: rgba(8, 8, 8, 0.85);
}
