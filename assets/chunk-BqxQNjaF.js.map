{"version":3,"file":"chunk-BqxQNjaF.js","sources":["../../src/types/messages.ts"],"sourcesContent":["export enum MessageType {\n  INIT_BACKGROUND = 'INIT_BACKGROUND',\n  VIDEO_CURRENT_TIMESTAMP = 'VIDEO_CURRENT_TIMESTAMP',\n  FINISH_TRANSLATE = 'FINISH_TRANSLATE',\n\n  TRANSLATED_SEGMENTS = 'TRANSLATED_SEGMENTS',\n  PHRASE_EXTRACTED_SEGMENTS = 'PHRASE_EXTRACTED_SEGMENTS',\n  NATIVE_LANGUAGE_CHANGE = 'NATIVE_LANGUAGE_CHANGE',\n  SUBTITLE_DATA = 'SUBTITLE_DATA',\n\n  // Debug page messages\n  GET_SUBTITLE_DATA = 'GET_SUBTITLE_DATA',\n  GET_SUBTITLE_DATA_RESPONSE = 'GET_SUBTITLE_DATA_RESPONSE',\n\n  // Authentication messages\n  CHECK_AUTH = 'CHECK_AUTH',\n  CHECK_AUTH_RESPONSE = 'CHECK_AUTH_RESPONSE',\n  OPEN_POPUP = 'OPEN_POPUP',\n  AUTH_LOGIN = 'AUTH_LOGIN',\n  AUTH_LOGOUT = 'AUTH_LOGOUT',\n  AUTH_REGISTER = 'AUTH_REGISTER',\n  AUTH_GET_USER = 'AUTH_GET_USER',\n  AUTH_STATE_CHANGED = 'AUTH_STATE_CHANGED',\n  AUTH_GOOGLE_LOGIN = 'AUTH_GOOGLE_LOGIN',\n  AUTH_GOOGLE_LOGIN_RESULT = 'AUTH_GOOGLE_LOGIN_RESULT', // Background → Popup: Google login result\n  AUTH_VERIFY_EMAIL = 'AUTH_VERIFY_EMAIL', // Popup → Background: Verify email with code\n  AUTH_RESEND_VERIFICATION = 'AUTH_RESEND_VERIFICATION', // Popup → Background: Resend verification email\n\n  // Generic API call (proxy to Background Service)\n  API_CALL = 'API_CALL',\n\n  // Stateless Background: Request-Response pattern\n  // Content Script sends request, Background calls API and returns response\n  TRANSLATE_REQUEST = 'TRANSLATE_REQUEST',\n  PHRASE_EXTRACT_REQUEST = 'PHRASE_EXTRACT_REQUEST',\n\n  // Collection Management Messages\n  // Request messages (Content Script/Popup → Background)\n  COLLECTION_LOAD = 'COLLECTION_LOAD', // Load collections for a video\n  COLLECTION_CREATE = 'COLLECTION_CREATE', // Create a new collection (call API + update cache + broadcast)\n  COLLECTION_REMOVE = 'COLLECTION_REMOVE', // Remove a collection (delete API + cache)\n  COLLECTION_CHECK = 'COLLECTION_CHECK', // Check if word is collected\n  COLLECTION_GET_LEMMAS = 'COLLECTION_GET_LEMMAS', // Get collected lemmas for highlighting\n\n  // Broadcast Events (Background → All Subscribers)\n  COLLECTION_ADDED = 'COLLECTION_ADDED', // Broadcast: collection added\n  COLLECTION_REMOVED = 'COLLECTION_REMOVED', // Broadcast: collection removed\n\n  // Settings Management Messages\n  // Request messages (Popup → Background)\n  SETTINGS_LOAD = 'SETTINGS_LOAD', // Load current settings\n  SETTINGS_SAVE = 'SETTINGS_SAVE', // Save settings (call storage + broadcast)\n\n  // Broadcast Events (Background → All YouTube tabs)\n  SETTINGS_CHANGED = 'SETTINGS_CHANGED', // Broadcast: settings changed (includes interfaceLanguage)\n}\n\nexport enum MessageSource {\n  XHR_INTERCEPTED = 'XHR_INTERCEPTED',\n  BACKGROUND = 'BACKGROUND',\n  CONTENT_SCRIPT = 'CONTENT_SCRIPT',\n  POPUP = 'POPUP',\n}\n\nexport interface Message {\n  source: MessageType | string\n  type: MessageSource | string\n  data: any\n  timestamp: number\n}\n\n// ============================================\n// Stateless Background: Request-Response Data\n// ============================================\n\nimport { Phrase, UserResponse } from '../tools/client'\n\n/**\n * Response data for TRANSLATE_REQUEST\n */\nexport interface TranslateResponseData {\n  success: boolean\n  segments?: string[]\n  error?: string\n}\n\n/**\n * Response data for PHRASE_EXTRACT_REQUEST\n */\nexport interface PhraseExtractResponseData {\n  success: boolean\n  phrases?: Phrase[][]\n  error?: string\n}\n\n/**\n * Broadcast data for AUTH_GOOGLE_LOGIN_RESULT\n * Sent from Background to Popup after Google OAuth flow completes\n */\nexport interface GoogleLoginResultData {\n  success: boolean\n  user?: UserResponse\n  error?: string\n}\n\n// ============================================\n// Collection Management Types\n// ============================================\n\n/**\n * Cached collection information\n * Used for checking if word is collected and for highlighting\n */\nexport interface CollectionInfo {\n  id: string // collection UUID\n  word: string // collected word\n  lemma: string | null // lemma (lowercase) for highlighting\n  segmentBegin: number // segment start time (ms) for unique key\n}\n\n/**\n * Request data for COLLECTION_LOAD\n */\nexport interface CollectionLoadRequest {\n  videoViewId: number\n  sourceLang: string\n}\n\n/**\n * Request data for COLLECTION_REMOVE\n */\nexport interface CollectionRemoveRequest {\n  videoViewId: number\n  collectionId: string\n}\n\n/**\n * Broadcast data for COLLECTION_REMOVED\n */\nexport interface CollectionRemovedData {\n  videoViewId: number\n  collectionId: string\n  word: string\n  lemma: string | null\n}\n\n// ============================================\n// Settings Management Types\n// ============================================\n\n/**\n * User settings stored in chrome.storage.sync\n */\nexport interface UserSettings {\n  nativeLanguage: string // e.g., 'zh-CN'\n  targetLanguage: string // e.g., 'en'\n  interfaceLanguage: string // e.g., 'zh_CN' (locale format)\n}\n\n/**\n * Request data for SETTINGS_SAVE\n */\nexport interface SettingsSaveRequest {\n  settings: Partial<UserSettings>\n}\n\n/**\n * Response data for SETTINGS_LOAD and SETTINGS_SAVE\n */\nexport interface SettingsResponse {\n  success: boolean\n  settings?: UserSettings\n  error?: string\n}\n\n/**\n * Broadcast data for SETTINGS_CHANGED\n */\nexport interface SettingsChangedData {\n  settings: UserSettings\n  changedKeys: (keyof UserSettings)[]\n}\n"],"names":["MessageType","MessageSource"],"mappings":"AAAO,IAAK,gCAAAA,iBAAL;AACLA,eAAA,iBAAA,IAAkB;AAClBA,eAAA,yBAAA,IAA0B;AAC1BA,eAAA,kBAAA,IAAmB;AAEnBA,eAAA,qBAAA,IAAsB;AACtBA,eAAA,2BAAA,IAA4B;AAC5BA,eAAA,wBAAA,IAAyB;AACzBA,eAAA,eAAA,IAAgB;AAGhBA,eAAA,mBAAA,IAAoB;AACpBA,eAAA,4BAAA,IAA6B;AAG7BA,eAAA,YAAA,IAAa;AACbA,eAAA,qBAAA,IAAsB;AACtBA,eAAA,YAAA,IAAa;AACbA,eAAA,YAAA,IAAa;AACbA,eAAA,aAAA,IAAc;AACdA,eAAA,eAAA,IAAgB;AAChBA,eAAA,eAAA,IAAgB;AAChBA,eAAA,oBAAA,IAAqB;AACrBA,eAAA,mBAAA,IAAoB;AACpBA,eAAA,0BAAA,IAA2B;AAC3BA,eAAA,mBAAA,IAAoB;AACpBA,eAAA,0BAAA,IAA2B;AAG3BA,eAAA,UAAA,IAAW;AAIXA,eAAA,mBAAA,IAAoB;AACpBA,eAAA,wBAAA,IAAyB;AAIzBA,eAAA,iBAAA,IAAkB;AAClBA,eAAA,mBAAA,IAAoB;AACpBA,eAAA,mBAAA,IAAoB;AACpBA,eAAA,kBAAA,IAAmB;AACnBA,eAAA,uBAAA,IAAwB;AAGxBA,eAAA,kBAAA,IAAmB;AACnBA,eAAA,oBAAA,IAAqB;AAIrBA,eAAA,eAAA,IAAgB;AAChBA,eAAA,eAAA,IAAgB;AAGhBA,eAAA,kBAAA,IAAmB;AAtDT,SAAAA;AAAA,GAAA,eAAA,CAAA,CAAA;AAyDL,IAAK,kCAAAC,mBAAL;AACLA,iBAAA,iBAAA,IAAkB;AAClBA,iBAAA,YAAA,IAAa;AACbA,iBAAA,gBAAA,IAAiB;AACjBA,iBAAA,OAAA,IAAQ;AAJE,SAAAA;AAAA,GAAA,iBAAA,CAAA,CAAA;"}